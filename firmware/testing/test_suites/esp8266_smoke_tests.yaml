# ESP8266 Smoke Tests
# Quick validation tests for ESP8266 firmware

name: "esp8266_smoke_tests"
description: "Quick smoke tests for ESP8266 firmware validation"
platform: "esp8266"
category: "smoke"

# Setup commands
setup_commands:
  - "reset"
  - "boot"
  - "wait:3"

# Teardown commands
teardown_commands:
  - "reset"

# Test cases
test_cases:
  - name: "boot_test"
    description: "Verify device boots correctly and responds to commands"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 15
    retry_count: 2
    parameters:
      command: "info"
      expected_response: "ESP8266"
      check_patterns:
        - "ESP8266"
        - "Ready"
        - "OK"
    
  - name: "memory_test"
    description: "Check available memory and heap status"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 10
    retry_count: 3
    parameters:
      command: "memory_info"
      min_free_heap: 25000
      max_heap_fragmentation: 30
      check_patterns:
        - "Free heap:"
        - "OK"
    
  - name: "gpio_basic_test"
    description: "Test basic GPIO functionality"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 10
    retry_count: 2
    parameters:
      command: "gpio_test"
      pin: 2
      mode: "output"
      value: 1
      check_patterns:
        - "GPIO"
        - "OK"
    
  - name: "wifi_scan_test"
    description: "Test WiFi scanning capability"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 20
    retry_count: 3
    parameters:
      command: "wifi_scan"
      min_networks: 1
      timeout: 15
      check_patterns:
        - "WiFi scan"
        - "Networks found:"
        - "OK"
    
  - name: "serial_test"
    description: "Test serial communication"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 10
    retry_count: 2
    parameters:
      command: "serial_test"
      test_string: "Hello ESP8266"
      check_patterns:
        - "Serial test"
        - "Echo:"
        - "OK"
    
  - name: "flash_test"
    description: "Test flash memory operations"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 15
    retry_count: 2
    parameters:
      command: "flash_test"
      test_size: 512
      check_patterns:
        - "Flash test"
        - "Write OK"
        - "Read OK"
        - "Verify OK"
    
  - name: "timer_test"
    description: "Test timer functionality"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 10
    retry_count: 2
    parameters:
      command: "timer_test"
      duration: 5
      check_patterns:
        - "Timer test"
        - "OK"
    
  - name: "watchdog_test"
    description: "Test watchdog timer functionality"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 15
    retry_count: 2
    parameters:
      command: "watchdog_test"
      timeout: 10
      check_patterns:
        - "Watchdog"
        - "OK"
    
  - name: "power_test"
    description: "Test power management features"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 15
    retry_count: 2
    parameters:
      command: "power_test"
      mode: "light_sleep"
      duration: 3
      check_patterns:
        - "Power test"
        - "Sleep mode"
        - "Wake up"
        - "OK"
    
  - name: "adc_test"
    description: "Test ADC functionality"
    test_type: "hardware"
    platform: "esp8266"
    timeout: 10
    retry_count: 3
    parameters:
      command: "adc_test"
      samples: 10
      check_patterns:
        - "ADC test"
        - "Raw value:"
        - "OK"